<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>OSCAL Profile Invocation Merge Specification (Diagrams)</title>
        <meta  charset="utf-8"/>
        <style type="text/css">

section { margin-top: 1em }

section section { clear: both;  overflow:hidden; padding: 0.5em; background-color: gainsboro }

.resolution, .profile, .catalog, .invoke, .group { display: inline-block; padding: 0.5em; margin: 0.5em; display: inline-grid }

// .invoke { padding: 0.5em; margin: 0.5em } 

div > * { vertical-align: top }

.catalog { border: medium double black }

.invoke { border: thin dotted black }
.profile { border: thin solid black }
.resolution { border: medium dotted grey }
.resolution .resolution { border: medium double grey }
p { margin: 0ex; padding-left: 1ex }

section > p { text-indent: 3em }
section > p:first-child { text-indent: 0em }

.subcontrol { padding-left: 2em; font-size: 80% }

.group > span { font-size: 80%; font-family: sans-serif }
.invoke > span { font-size: 80%; font-style: italic  }

.exclude { color: grey }
.exclude:before { content: 'exclude: '; text-decoration: none;
  font-family: sans-serif; font-size: 70% }

.error { color: red }
.stress { color: green }

        </style>
    </head>
    <body>

        <section>
            <p>A profile may combine more than one invocation.</p>
            <figure>
                
                <div class="profile">
                    <span>OK Profile</span>
                    <div class="invoke">
                        <span>Invoke Catalog A</span>
                    </div>
                    <div class="invoke">
                        <span>Invoke Catalog B</span>
                    </div>
                </div>
            </figure>
                
        </section>
        <section>
            <p>An invocation is bound to a single catalog or profile, its "resource". If bound to a profile, it is implicitly resolved according to these same rules. Because profiles must be bound to either catalogs, or profiles, this means that (ipso facto) all profiles capable of finite resolution, resolve eventually to catalogs.</p>
            <p>Note that the same catalog may appear at multiple "leaf" positions in the invocation tree.</p>
            <figure>
                <div class="profile">
                    <span>OK Profile</span>
                    <div class="invoke">
                        <span>Invoke Catalog A</span>
                    </div>
                    <div class="invoke">
                        <span>Invoke Profile B1</span>
                    </div>
                </div>
                <div class="profile">
                    <span>B1 Profile</span>
                    <div class="invoke">
                        <span>Invoke Catalog B</span>
                    </div>
                </div>
            </figure>
            <figure>
                <div class="profile">
                    <span>Also OK Profile</span>
                    <div class="invoke">
                        <span class="stress">Invoke Catalog A</span>
                    </div>
                    <div class="invoke">
                        <span>Invoke Profile A1</span>
                    </div>
                </div>
                <div class="profile">
                    <span>A1 Profile</span>
                    <div class="invoke">
                        <span class="stress">Invoke Catalog A</span>
                    </div>
                </div>
            </figure>
        </section>
        <section>
            <p>If an OSCAL profile includes, directly or indirectly, any invocations of itself as a resource, such invocations are inoperable. Such circular reference is an error. A processor may fall back by ignoring circular calls (i.e. invocations of resources that have already been invoked higher in the stack).</p>
            <p>Because circular references are defined as inoperable, in the real world all profiles will be finite. References to URI targets not identifiable as OSCAL (catalogs, profiles or document types tbd) must return nothing.</p>
            <figure>
                <div class="profile">
                    <span>Perplex Profile</span>
                    <div class="invoke">
                        <span>Invoke Plexper profile</span>
                    </div>
                </div>
                <div class="profile">
                    <span>Plexper Profile</span>
                    <div class="invoke">
                        <span>Invoke Perplex profile</span>
                    </div>
                </div>
                <div class="resolution"><span>Resolution of Perplex Profile</span>
                    <div class="invoke"><span>Invoke Plexper profile</span>
                        <div class="invoke error"><span>Invoke Perplex profile</span>
                        </div>
                    </div>
                </div>
            </figure>
        </section>
        <section>
            <p>An invocation can identify controls (as given in and by the resource) for inclusion
                in either of two ways. The first method is by an explicit "call" using the ID of the
                desired control or subcontrol.</p>
            <figure>
                <div class="catalog">
                    <span>CQZ Controls Catalog</span>
                    <div class="group">
                        <span>Group CC</span>
                        <p class="control">Control CCA</p>
                        <p class="control">Control CCB</p>
                        <p class="control">Control CCC</p>
                    </div>
                    <div class="group">
                        <span>Group QQ</span>
                        <p class="control">Control QQA</p>
                        <p class="control">Control QQB</p>
                        <p class="control">Control QQC</p>
                    </div>
                    <div class="group">
                        <span>Group ZZ</span>
                        <p class="control">Control ZZA</p>
                        <p class="control">Control ZZB</p>
                        <p class="control">Control ZZC</p>
                    </div>
                </div>
                <div class="profile">
                    <span>A profile CQ/Z "slim"</span>
                    <div class="invoke">
                        <span>Invoke CQZ controls catalog</span>
                        <p class="call">Control CCA</p>
                        <p class="control">Control QQC</p>
                    </div>
                </div>
                <div class="resolution">
                    <span>Resolution of CQ/Z "slim" profile</span>
                    <div class="invoke">
                        <span>Invoke CQZ controls catalog</span>
                        <div class="resolution">
                            <span>CQZ Controls Catalog</span>
                            <div class="group">
                                <span>Group CC</span>
                                <p class="control">Control CCA</p>
                            </div>
                            <div class="group">
                                <span>Group QQ</span>
                                <p class="control">Control QQC</p>
                            </div>
                        </div>
                    </div>
                </div>
            </figure>
            <p>When controls from a catalog are included in resolution, a proxy of the entire
                catalog structure, including any grouping structure in which selected controls
                appear, is included. This permits structured representation of contents of the
                catalog outside of the groups containing selected controls.</p>
            <p>Note that one consequence of this is that certain information from catalogs,
                specifically titles and text at the top level and group levels, will be represented
                in resolved profiles of those catalogs, but may "decay" as their contents (controls)
                are selected and modified (in the sense that their semantic relations and
                representations will be less and less applicable). Good catalog design will help
                mitigate this; and applications are able to trace the provenance of such information
                (indeed, here the information is retained for purposes of tracing provenance as well
                as representing the data as given).</p>
        </section>
        <section>
            <p>Alternatively, an invocation can indicate that all controls from the catalog (or
                upstream profile) should be included.</p>
            <figure>
                <div class="catalog">
                    <span>CQ Controls Catalog</span>
                    <div class="group">
                        <span>Group CC</span>
                        <p class="control">Control CCA</p>
                        <p class="control">Control CCB</p>
                        <p class="control">Control CCC</p>
                    </div>
                    <div class="group">
                        <span>Group QQ</span>
                        <p class="control">Control QQA</p>
                        <p class="control">Control QQB</p>
                        <p class="control">Control QQC</p>
                    </div>
                </div>
                <div class="profile">
                    <span>An "identity profile" of CQ</span>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <p class="all">All</p>
                    </div>
                </div>
                <div class="profile">
                    <span>A more literal "identity profile" of CQ</span>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <p class="call">Control CCA</p>
                        <p class="call">Control CCB</p>
                        <p class="call">Control CCC</p>
                        <p class="call">Control QQA</p>
                        <p class="call">Control QQB</p>
                        <p class="call">Control QQC</p>
                    </div>
                </div>
                <div class="resolution">
                    <span>Resolution of (either) CQ Identity Profile</span>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <div class="resolution">
                            <span>CQ Controls Catalog</span>
                            <div class="group">
                                <span>Group CC</span>
                                <p class="control">Control CCA</p>
                                <p class="control">Control CCB</p>
                                <p class="control">Control CCC</p>
                            </div>
                            <div class="group">
                                <span>Group QQ</span>
                                <p class="control">Control QQA</p>
                                <p class="control">Control QQB</p>
                                <p class="control">Control QQC</p>
                            </div>
                        </div>
                    </div>
                </div>
            </figure>
        </section>
        <section>
            <p>It is more common to use "include/all" with an exclusion rule – or to use exclusion
                rules with only an implicit call to "all" (which will be inferred when no other
                inclusion is given):</p>
            <figure>
                <div class="profile">
                    <span>"Almost All" profile of CQ</span>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <p class="all">All</p>
                        <p class="exclude">Control QQC</p>
                    </div>
                </div><div class="profile">
                    <span>"Almost All" profile of CQ (implicit "all")</span>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <p class="exclude">Control QQC</p>
                    </div>
                </div>
                <div class="resolution">
                    <span>Resolution of (either) "Almost All" CQ Profile</span>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <div class="resolution">
                            <span>CQ Controls Catalog</span>
                            <div class="group">
                                <span>Group CC</span>
                                <p class="control">Control CCA</p>
                                <p class="control">Control CCB</p>
                                <p class="control">Control CCC</p>
                            </div>
                            <div class="group">
                                <span>Group QQ</span>
                                <p class="control">Control QQA</p>
                                <p class="control">Control QQB</p>
                            </div>
                        </div>
                    </div>
                </div>
            </figure>
        </section>
        <section>
            <p>Note that if no explicit inclusion rule is given (irrespective of exclusions), a processor should "include all" in any case:</p>
            <figure>
                <div class="profile">
                    <span>"Null invocation" profile of CQ is effectively "All"</span>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                    </div>
                </div>
                <div class="resolution">
                    <span>Resolution of "Null invocation" CQ Profile</span>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <div class="resolution">
                            <span>CQ Controls Catalog</span>
                            <div class="group">
                                <span>Group CC</span>
                                <p class="control">Control CCA</p>
                                <p class="control">Control CCB</p>
                                <p class="control">Control CCC</p>
                            </div>
                            <div class="group">
                                <span>Group QQ</span>
                                <p class="control">Control QQA</p>
                                <p class="control">Control QQB</p>
                            </div>
                        </div>
                    </div>
                </div>
            </figure>
            <p>So why would you ever use "all"? If all controls are included by default, then just including
                or excluding controls by ID ought to be sufficient. (Perhaps following the rule that if any controls are included by ID, "all" goes off.) An explicit instruction to include "all" becomes useful once subcontrols come into the picture. Before we illustrate subcontrols (control enhancements), however, we have ...</p>
            
        </section>
        
        <section>
            <h2>Cabinet of Horrors</h2>
            <p>We can illustrate a number of edge case scenarios, including both errors and exceptional or near-exceptional (but illustrative) cases.</p>
        <section>
            
            <figure>
                
                <div class="profile">
                    <span>Competing (CQ and CQ) Profile</span>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <p class="call">Control CCB</p>
                        <p class="call">Control CCC</p>
                        <p class="call">Control QQC</p>
                        <p class="call">Control QQA</p>
                    </div>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <p class="call">Control CCA</p>
                    </div>
                </div>
                <div class="resolution"><span>Resolution of Competing (CQ) Profile</span>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <div class="resolution">
                            <span>CQ Controls Catalog</span>
                            <div class="group">
                                <span>Group CC</span>
                                <p class="control">Control CCB</p>
                                <p class="control">Control CCC</p>
                            </div>
                            <div class="group">
                                <span>Group QQ</span>
                                <p class="control">Control QQA</p>
                                <p class="control">Control QQC</p>
                            </div>
                        </div>
                    </div>
                    <div class="invoke">
                        <span>Invoke CQ controls catalog</span>
                        <div class="resolution">
                            <span>CQ Controls Catalog</span>
                            <div class="group">
                                <span>Group CC</span>
                                <p class="control">Control CCA</p>
                            </div>
                        </div>
                    </div>
                </div>
            </figure>
            <p>In this case, two invocations call (reference) the same control catalog. This is not regarded as an error, but only because there are no actual conflicts between the invocations (when they are resolved). A warning might be offered to provide an alert that a more efficient representation would be possible.</p> 
        </section>
        </section>
    </body>
</html>
