<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!-- 
    <xsd:element name="overlay">
        <xsd:complexType>
            <xsd:complexContent>
                <xsd:extension base="layerType">
                    <xsd:sequence>
                        <xsd:element maxOccurs="1" minOccurs="1" name="base" type="baseType"/>
                        <xsd:element maxOccurs="1" minOccurs="0" name="items">
                            <xsd:complexType>
                                <xsd:sequence>
                                    <xsd:element maxOccurs="unbounded" minOccurs="1" name="item"
                                        type="layerItemType"/>
                                </xsd:sequence>
                            </xsd:complexType>
                        </xsd:element>
                    </xsd:sequence>
                </xsd:extension>
            </xsd:complexContent>
        </xsd:complexType>
    </xsd:element>
 -->
<overlay 
	xmlns="http://oscal.nist.gov/schema/core"
    xmlns:xh11d="http://www.w3.org/1999/xhtml/datatypes/"
    xmlns:xhtml="http://www.w3.org/1999/xhtml"    
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:xfedramp="http://oscal.nist.gov/schema/extension-baseline-FedRAMP"   
    xsi:schemaLocation="http://oscal.nist.gov/schema/core file:../../../../../xsd/nist/oscal/2.0/latest/OSCAL-core.xsd
       		http://oscal.nist.gov/schema/OSCAL-extension-baseline-FedRAMP 
        	file:../../../../../xsd/nist/oscal/2.0/latest/OSCAL-extension-baseline-FedRAMP.xsd" >
        
    <id>FedRAMP-Low</id>
    <!-- <name>Fed RAMP Low overlay</name>  overlays are now called profiles -->
    <name>Fed RAMP Low profile</name>
    <version>1</version>
    <summary>TBD</summary>
    <base>
        <layer-ref id="SP800-53" version="4" type="catalog" 
            URI="../../../../xml/nist/oscal/2.0/latest/catalog_controls_sp800-53.xml" />                
        <layer-ref id="SP800-53-Low" version="4" type="catalog" 
            URI="../../../../xml/nist/oscal/2.0/latest/profile_baseline_mod_sp800-53.xml" />  
        <!-- filename change above reflects that overlays are now called profiles -->      
    </base>
    <!-- <baseline-impact>Low</baseline-impact> -->  
    <!-- all controls from the profiles (overlays) defined in base above are automatically included unless modified below -->
    <!-- additional controls may be added from catalogs -->
    <meta>
        <property name="supplemental-guidance" type="xhtml:xhtml.div.type"/>
        <property name="implementation-guidance" type="xhtml:xhtml.div.type"/>
        <tailor>
            <property name="supplemental-guidance" minOccurs="0" maxOccurs="1" />
            <property name="implementation-guidance" minOccurs="0" maxOccurs="1" />
        </tailor>
    </meta>
    <items>
    	<item>
    		<!-- retain type text as parameter values are "overlain" onto security control implementation guidance 
    		and may override them -->
            <type>control-overlay</type>
            <id>AC-1</id>
            <link rel="parent">SP800-53#AC-1</link>
            <parameter>
                <name>AC-1 (b) (1)</name>
                <description>at least every 3 years</description>
            </parameter>
            <parameter>
            	<name>AC-1 (b) (2)</name>
                <description>at least annually</description>
            </parameter>
            <properties>
                <!-- validated under extension schema for the FedRAMP overlay -->
                <xfedramp:sort-id>AC-01</xfedramp:sort-id>                             
            </properties>
        </item>
    	<item>
            <type>control-overlay</type>
            <id>AC-8</id>
            <link rel="parent">SP800-53#AC-8</link>
            <parameter>
                <name>AC-8 (a)</name>
                <description>see additional Requirements and Guidance</description>
            </parameter>
            <parameter>
            	<name>AC-8 (c)</name>
                <description>see additional Requirements and Guidance</description>
            </parameter>
            <requirement>The service provider shall determine elements of the cloud environment that require the System Use Notification control. The elements of the cloud environment that require System Use Notification are approved and accepted by the JAB.
            </requirement>
            <requirement>The service provider shall determine how System Use Notification is going to be verified and provide appropriate periodicity of the check. The System Use Notification verification and periodicity are approved and accepted by the JAB.
            </requirement>
            <requirement>If not performed as part of a Configuration Baseline check, then there must be documented agreement on how to provide results of verification and the necessary periodicity of the verification by the service provider. The documented agreement on how to provide verification of the results are approved and accepted by the JAB.
            </requirement>
            <guidance>If performed as part of a Configuration Baseline check, then the % of items requiring setting that are checked and that pass (or fail) check can be provided.
            </guidance>
            <properties>
                <!-- validated under extension schema for the FedRAMP overlay -->
                <xfedramp:sort-id>AC-08</xfedramp:sort-id>                             
            </properties>
        </item>
        <item>
            <type>control-overlay</type>
            <id>CA-2</id>
            <link rel="parent">SP800-53#CA-2</link>
            <parameter>
                <name>CA-2b</name>
                <description>at least annually</description>
            </parameter>
            <parameter>
            	<name>CA-2d</name>
                <description>individuals or roles to include FedRAMP PMO</description>
            </parameter>
            <properties>
                <!-- validated under extension schema for the FedRAMP overlay -->
                <xfedramp:sort-id>CA-02</xfedramp:sort-id>                             
            </properties>
        </item>
        <item>
            <!-- the next properties specify that this overlay adds ("supplements") the CA-2 (1) control from the
                "layer" SP800-53; if one looks in the <base> above the layer with ID "SP800-53" points to the SP800-53 catalog;
                so the paid: <id>, <link rel="layer"> specify a control in a catalog, overlay, etc;
            -->
            <type>control-overlay</type>
            <id>CA-2 (1)</id>
            <link rel="parent">#CA-2</link>
            <link rel="parent">SP800-53#CA-2 (1)</link>
            <rationale change="supplemented">added from Moderate baseline of the SP800-53 catalog.</rationale>
            <requirement>Must use an accredited 3PAO for JAB authorization</requirement>
            <guidance></guidance>
       		<properties>
                <!-- validated under extension schema for the FedRAMP overlay -->
                <xfedramp:sort-id>CA-02 (01)</xfedramp:sort-id>                             
            </properties>
        </item>
        <item>
            <!-- as above -->
            <type>control-overlay</type>
            <id>CA-2 (2)</id>
            <link rel="parent">#CA-2</link>
            <link rel="parent">SP800-53#CA-2 (2)</link>
            <rationale change="supplemented">added from Moderate baseline of the SP800-53 catalog.</rationale>
            <requirement>To include 'announced', 'vulnerability scanning'</requirement>
            <guidance></guidance>
       		<properties>
                <!-- validated under extension schema for the FedRAMP overlay -->
                <xfedramp:sort-id>CA-02 (01)</xfedramp:sort-id>                             
            </properties>
        </item>
        <!-- add each objective from the objectives catalog here, 
            or would one assume that all the objectives corresponding to controls in base overlays are included? 
            For now, I am listing each objective but the assumption would simplify things; one would list here
            an objective only if more tailoring is needed.
        -->
        <item>
            <type>objective</type>
            <id>AC-1</id>
            <link rel="layer">SP800-53A</link>
            <rationale change="supplemented" />
            <properties>
                <!-- validated under extension schema for the FedRAMP overlay -->
                <xfedramp:sort-id>AC-01</xfedramp:sort-id>                             
            </properties>
        </item>
        <!-- add more objectives here -->
        
        <!-- corresponding objective to the control supplemented from the moderate baseline -->
        <item>
            <type>objective</type>
            <id>CA-2 (1)</id>
            <link rel="layer">SP800-53A</link>
            <rationale change="supplemented">added from Moderate baseline of the SP800-53A catalog.</rationale>
            <properties>
                <!-- validated under extension schema for the FedRAMP overlay -->
                <xfedramp:sort-id>CA-02 (01)</xfedramp:sort-id>                             
            </properties>
        </item>
    </items>	 
</overlay>